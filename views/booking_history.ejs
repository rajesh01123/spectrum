<%- include ("uheader.ejs") %>
<%- include ("unavbar.ejs") %>





       
      <!-- Main Content -->
      <div class="main-content">
        
       
                    
           

        <section class="section">

          <% if (output === 'Error in fetching user' || output === 'Failed to Update' ) { %>
            <div  class="alert alert-danger">
                <%= output %>
            </div>
            <% }else if(output===''){
            } else { %>
            <div class="alert alert-success mb-1">
                <%= output %>
            </div>                                   
            <% } %>
            <div class="fulls-headings">
                <h4> <i class="fa fa-th-large" aria-hidden="true"></i>Booking History</h4>
              </div>
            <div class="row">
                
                <div class="fully-tables">
               
                  
                    <div class="table-reponsive box">
                        <div id="example_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer">
                            <div class="row">
                                <table id="example" class="table table-striped table-bordered dataTable no-footer" role="grid" aria-describedby="example_info">
                                    <thead>
                                        <tr role="row">
                                            <th style="width: 30px;">Sr. No</th>
                                            <!-- <th style="width: 100px;">Event Title</th> -->
                                            <th style="width: 100px;">Event Name</th>

                                            <th style="width: 100px;">Event Type</th>
                                            <th style="width: 100px;">Event payment</th>
                                            <th style="width: 100px;">status</th>
                                            <th style="width: 100px;">Action</th>

                                            <th style="width: 100px;">Action</th>

                                           
                                            
                                        </tr>
                                    </thead>
                                    <tbody>
                                      <% for(var i=0; i< booking_data.length; i++) {%>
                                        <tr>
                                            <td><%- i+1  %></td>
                                            <!-- <td><%- //booking_data[i].title %></td> -->

                                            <td><%- booking_data[i].event_name %></td>
                                            <td><%- booking_data[i].event_type %></td>
                                            <td><%- booking_data[i].payment %></td>
                                            <td><%- booking_data[i].status %></td>
                                            <td id="lon"></td>

                                            <td>
                                              <div class="dropdown">
                                                  <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                      Action
                                                  </button>
                                                  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                                                    <form method="post" action="chekin">
                                                      <input type="hidden" id="lat" name="current_lat">
                                                      <input type="hidden" id="long" name="current_lon">
                                                      <input type="hidden"  name="event_address" value="<%-booking_data[i].venue_location  %>">
                                                      <input type="hidden"  name="event_lat" value="<%-booking_data[i].lat  %>">
                                                      <input type="hidden"  name="event_lon" value="<%-booking_data[i].lon  %>">
                                                      
                                                      <input type="hidden"  name="event_date" value="<%-booking_data[i].date  %>">
                                                       
                                                      <input type="submit" class="dropdown-item" value="chekh in">
                                                    </form>
                                                      
                                                      <a class="dropdown-item delete-user-link" onclick="deleteit('<%-  %>')"  data-user-id="1">Delete</a>
                                                  </div>
                                              </div>
                                          </td>
                                            
                                           
                                            
                                            <!-- <td>
                                                <div class="dropdown">
                                                    <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                        Payment
                                                    </button>
                                                </div>
                                            </td> -->
                                        </tr>
                                        <% } %>
                                    </tbody>                            
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
      </div>
      <footer class="main-footer">
        <div class="footer-left">
          Copyright Â© 2025  <a href="#">Spectrum Sports </a> All rights reserved
        </div>
        <div class="footer-right">
        </div>
      </footer>
    </div>
  </div>
  <!-- General JS Scripts -->
  <script src="/assets/js/app.min.js"></script>
  <!-- JS Libraies -->
  <script src="/assets/bundles/apexcharts/apexcharts.min.js"></script>
  <!-- Page Specific JS File -->
  <script src="/assets/js/page/index.js"></script>
  <!-- Template JS File -->
  <script src="/assets/js/scripts.js"></script>
  <!-- Custom JS File -->
  <script src="/assets/js/custom.js"></script>
<!-- CANVAS CHART JS  SCRIPT START  CANVAS CHART JS  SCRIPT START  CANVAS CHART JS  SCRIPT START  -->



<script>

 

readmore = true;


window.onload = function () {

 DATAPOINTS =  document.getElementById('dataPoints').value; 
 DATAPOINTS = JSON.parse(DATAPOINTS)

 clientIp =  document.getElementById('clientIp').value; 

 const timestamp = new Date().toString();
   LastLogin = `From IP- ${clientIp} on ${timestamp} `;

    var halfLength = Math.ceil(LastLogin.length / 4);

    document.getElementById('lastlogin').innerText  =  LastLogin.substring(0, halfLength);

   

var chart = new CanvasJS.Chart("chartContainer", {
  animationEnabled: true,
  theme: "light2", // "light1", "light2", "dark1", "dark2"
  title:{
    text: "Top Interested Properties"
  },
  axisY: {
    title: "Interest Count"
  },
  data: [{        
    type: "column",  
    showInLegend: true, 
    legendMarkerColor: "grey",
    legendText: "MyRentWish",
    dataPoints: DATAPOINTS
  }]
});
chart.render();

}




function toggleReadMore() {  
    var readMoreContent = document.getElementById('readMoreContent');

    // Toggle the display of the read more content
    if (readmore == true) { 
       lastlogin.style.display = 'inline';
       document.getElementById('lastlogin').innerText  =  LastLogin
       readmore = false; 

    } else {
      document.getElementById('lastlogin').innerText  =  LastLogin.substring(0, halfLength);  
      readmore = true;    
    }
  }

  
</script>

<script>
  function getLocation() { 
      navigator.geolocation.getCurrentPosition(async (position) => {
          let lat = position.coords.latitude;
          let lon = position.coords.longitude;
          
          // Your Google Maps API key (make sure it's valid)
          let apiKey = "AIzaSyCv9Q8xCsuO1dbraoQn1e6RfNRNyDRj8p4";
          let url = `https://maps.googleapis.com/maps/api/geocode/json?latlng=${lat},${lon}&key=${apiKey}`;
      
          let response = await fetch(url);
          let data = await response.json();
          const address = data.results[0].formatted_address;

          // Setting lat and lon values in the hidden input fields
          document.getElementById("lat").value = lat;
          document.getElementById("long").value = lon;

          // Logging lat and lon to the console
          console.log("Latitude:", lat);
          console.log("Longitude:", lon);
          console.log("Address:", address);
      }, (error) => {
          console.error("Error getting location:", error);
      });
  }

  // Call the getLocation function to fetch the location when the page loads
  window.onload = getLocation;
</script>


</body>


<!-- index  21 Nov 2019 03:47:04 GMT -->
</html>